Index: experimentation/visualize.ipynb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/experimentation/visualize.ipynb b/experimentation/visualize.ipynb
--- a/experimentation/visualize.ipynb	
+++ b/experimentation/visualize.ipynb	
@@ -429,9 +429,9 @@
           -0.022883644327521324,
           0.01663290709257126,
           0.044764310121536255,
-          0.00046883546747267246,
+          4.6883546747267246E-4,
           -0.019933007657527924,
-          -0.0006055310368537903,
+          -6.055310368537903E-4,
           0.09154988080263138,
           -0.06733804941177368,
           -0.044729381799697876,
@@ -516,7 +516,7 @@
           0.04863767698407173,
           0.027051322162151337,
           0.22365424036979675,
-          -0.0008060596883296967,
+          -8.060596883296967E-4,
           0.10198170691728592,
           -0.07281168550252914,
           -0.19667565822601318,
@@ -862,12 +862,12 @@
           -0.10866492986679077,
           -0.08897324651479721,
           -0.0896841362118721,
-          -0.0008227688958868384,
+          -8.227688958868384E-4,
           0.005219804123044014,
           0.0027316859923303127,
           0.09841760993003845,
           -0.03075127862393856,
-          0.0003857457486446947,
+          3.857457486446947E-4,
           0.010622575879096985,
           -0.03992177173495293,
           -0.03558533638715744,
@@ -1009,7 +1009,7 @@
           -0.05042664334177971,
           -0.12322187423706055,
           -0.1131272241473198,
-          -0.0008775424212217331,
+          -8.775424212217331E-4,
           0.09054303169250488,
           0.1467745155096054,
           0.06935848295688629,
@@ -2141,7 +2141,7 @@
           0.1434401124715805,
           0.010472569614648819,
           0.08477918803691864,
-          -0.0009482838213443756,
+          -9.482838213443756E-4,
           -0.3076416850090027,
           -0.11600805819034576,
           -0.1874013990163803,
@@ -2156,7 +2156,7 @@
           -0.18671174347400665,
           -0.0056720152497291565,
           -0.13158753514289856,
-          0.0009570012334734201,
+          9.570012334734201E-4,
           -0.20632719993591309,
           0.024664055556058884,
           0.016085244715213776,
@@ -2170,7 +2170,7 @@
           -0.44336986541748047,
           0.020137641578912735,
           0.021102169528603554,
-          0.0003707408905029297,
+          3.707408905029297E-4,
           -0.18497590720653534,
           -0.09362412989139557,
           0.0613095760345459,
@@ -2226,7 +2226,7 @@
           -0.025892935693264008,
           0.02797265350818634,
           0.0012690499424934387,
-          -0.0005737850442528725,
+          -5.737850442528725E-4,
           -0.10057828575372696,
           0.07518729567527771,
           -0.01484755426645279,
@@ -2387,7 +2387,7 @@
           0.006174582988023758,
           -0.03452843800187111,
           -0.5225169658660889,
-          0.0005868934094905853,
+          5.868934094905853E-4,
           0.13724900782108307,
           0.05254431068897247,
           0.10122010111808777,
@@ -2509,7 +2509,7 @@
           0.1486394852399826,
           0.19053812325000763,
           0.08009907603263855,
-          0.00017379863129463047,
+          1.7379863129463047E-4,
           0.07056352496147156,
           0.011269715614616871,
           0.03652448579668999,
@@ -3852,7 +3852,7 @@
           0.11013732105493546,
           -0.16928106546401978,
           -0.06616157293319702,
-          0.0001095309853553772,
+          1.095309853553772E-4,
           -0.08688183128833771,
           -0.15362496674060822,
           -0.23411212861537933,
@@ -3871,7 +3871,7 @@
           0.30937132239341736,
           -0.03625217825174332,
           0.0563860684633255,
-          -0.0006204396486282349,
+          -6.204396486282349E-4,
           0.1780676692724228,
           -0.3655642867088318,
           0.08912502229213715,
@@ -3908,7 +3908,7 @@
           -0.05035161226987839,
           0.09153927117586136,
           0.09224683046340942,
-          0.0009275004267692566,
+          9.275004267692566E-4,
           0.06978325545787811,
           0.059150341898202896,
           -0.09429629147052765,
@@ -4166,7 +4166,7 @@
           0.1317683309316635,
           -0.05928891897201538,
           -0.002576743485406041,
-          0.00046919938176870346,
+          4.6919938176870346E-4,
           -0.20989897847175598,
           0.30783548951148987,
           0.27730071544647217,
@@ -4412,7 +4412,7 @@
           -0.25043657422065735,
           -0.12672331929206848,
           -0.04201933741569519,
-          -0.0003488765505608171,
+          -3.488765505608171E-4,
           0.0036104663740843534,
           -0.04162989556789398,
           0.14478376507759094,
@@ -4444,7 +4444,7 @@
           0.033792342990636826,
           -0.04688738286495209,
           -0.11640306562185287,
-          0.0008194542024284601,
+          8.194542024284601E-4,
           0.04898064211010933,
           -0.07382389903068542,
           -0.1173117607831955,
@@ -5739,7 +5739,7 @@
           0.04400244355201721,
           0.36511340737342834,
           -0.5431308150291443,
-          0.00022795540280640125,
+          2.2795540280640125E-4,
           0.272500216960907,
           0.043987832963466644,
           -0.09841343760490417,
@@ -5762,10 +5762,10 @@
           -0.0012656482867896557,
           -0.30282557010650635,
           0.0018404691945761442,
-          0.0002423460828140378,
+          2.423460828140378E-4,
           -0.12484579533338547,
           0.012696634978055954,
-          -0.0005156485131010413,
+          -5.156485131010413E-4,
           0.012304788455367088,
           0.3204053044319153,
           0.05873380973935127,
@@ -5780,8 +5780,8 @@
           -0.16685712337493896,
           0.0629773661494255,
           0.3004958927631378,
-          0.00007662596181035042,
-          0.00005448958836495876,
+          7.662596181035042E-5,
+          5.448958836495876E-5,
           -0.022101612761616707,
           -0.24656608700752258,
           0.004387798719108105,
@@ -5793,7 +5793,7 @@
           0.47890493273735046,
           -0.007104078307747841,
           0.08255983889102936,
-          0.000524353701621294,
+          5.24353701621294E-4,
           -0.4638119339942932,
           -0.021151024848222733,
           -0.012261524796485901,
@@ -5807,7 +5807,7 @@
           0.5482985973358154,
           -0.05075731500983238,
           -0.03093787655234337,
-          0.00009999959729611874,
+          9.999959729611874E-5,
           0.011136726476252079,
           -0.023369424045085907,
           0.01267721876502037,
@@ -8453,7 +8453,7 @@
           0.12428431957960129,
           0.1899508535861969,
           0.06565723568201065,
-          -0.00016689983021933585,
+          -1.6689983021933585E-4,
           -0.04082762077450752,
           -0.28505459427833557,
           -0.19002199172973633,
@@ -8614,7 +8614,7 @@
           -0.036835093051195145,
           -0.14505355060100555,
           -0.030636172741651535,
-          -0.00021943305910099298,
+          -2.1943305910099298E-4,
           -0.04876013845205307,
           0.005821888335049152,
           -0.024016985669732094,
@@ -8734,7 +8734,7 @@
           0.11901818215847015,
           0.13293948769569397,
           0.16729621589183807,
-          0.00018801366968546063,
+          1.8801366968546063E-4,
           0.008225597441196442,
           -0.01100156456232071,
           0.011797857470810413,
@@ -8749,7 +8749,7 @@
           0.011745324358344078,
           0.013689053244888783,
           0.02908129058778286,
-          0.000450679799541831,
+          4.50679799541831E-4,
           -0.018041016533970833,
           -0.03227752074599266,
           -0.022769007831811905,
@@ -10194,7 +10194,7 @@
           -0.0941803827881813,
           -0.02223929949104786,
           -0.05616004019975662,
-          0.0009718912770040333,
+          9.718912770040333E-4,
           0.024599311873316765,
           -0.17974317073822021,
           0.2245544046163559,
@@ -10513,7 +10513,7 @@
           0.04295555502176285,
           0.0944087952375412,
           -0.10652131587266922,
-          -0.00032588004251010716,
+          -3.2588004251010716E-4,
           -0.07449118047952652,
           -0.17446181178092957,
           -0.1611492931842804,
@@ -10529,7 +10529,7 @@
           -0.03220326080918312,
           -0.11185191571712494,
           -0.08880330622196198,
-          0.00027710868744179606,
+          2.7710868744179606E-4,
           -0.09970828890800476,
           -0.09930341690778732,
           0.01785467006266117,
@@ -10547,7 +10547,7 @@
           -0.0074528660625219345,
           0.03195156157016754,
           -0.12846463918685913,
-          0.0008947518072091043,
+          8.947518072091043E-4,
           -0.0766417384147644,
           -0.07965843379497528,
           0.0025839887093752623,
@@ -11339,7 +11339,7 @@
           -0.17060953378677368,
           -0.10941626876592636,
           0.1094244122505188,
-          0.0007162897381931543,
+          7.162897381931543E-4,
           -0.0272668544203043,
           0.20793190598487854,
           0.18668949604034424,
@@ -12022,7 +12022,7 @@
           -0.05700602009892464,
           -0.05906280502676964,
           0.06346406042575836,
-          0.00021883314184378833,
+          2.1883314184378833E-4,
           -0.06469324231147766,
           -0.05776423215866089,
           -0.06103534623980522,
@@ -12046,9 +12046,9 @@
           -0.06059105321764946,
           -0.06630381941795349,
           -0.2314554899930954,
-          0.0005124174058437347,
+          5.124174058437347E-4,
           0.06548571586608887,
-          0.000683254562318325,
+          6.83254562318325E-4,
           0.02739573083817959,
           -0.053770314902067184,
           0.03700007498264313,
@@ -12088,7 +12088,7 @@
           0.3332812488079071,
           -0.023199865594506264,
           -0.080146424472332,
-          -0.0002158403949579224,
+          -2.158403949579224E-4,
           -0.07621748745441437,
           -0.06396665424108505,
           -0.03686670586466789,
@@ -12303,7 +12303,7 @@
           0.11654739081859589,
           0.10739782452583313,
           -0.04344795644283295,
-          0.00020573960500769317,
+          2.0573960500769317E-4,
           -0.07756373286247253,
           0.10204993188381195,
           -0.0774918720126152,
@@ -12661,7 +12661,7 @@
           0.09775537252426147,
           0.12839177250862122,
           0.10945899039506912,
-          0.0002662466431502253,
+          2.662466431502253E-4,
           0.05170547589659691,
           0.016106178984045982,
           -0.0065153660252690315,
@@ -14946,7 +14946,7 @@
           0.010311218909919262,
           -0.01597314514219761,
           0.021953659132122993,
-          0.0004906869144178927,
+          4.906869144178927E-4,
           0.03886185958981514,
           0.13591182231903076,
           0.10742783546447754,
@@ -15498,7 +15498,7 @@
           -0.04203532636165619,
           -0.012773696333169937,
           0.00926695391535759,
-          -0.0005980146233923733,
+          -5.980146233923733E-4,
           0.01202203519642353,
           0.04097260907292366,
           0.05745865777134895,
@@ -19060,11 +19060,67 @@
    ]
   },
   {
+   "cell_type": "code",
+   "execution_count": 11,
+   "metadata": {},
+   "outputs": [
+    {
+     "name": "stdout",
+     "output_type": "stream",
+     "text": [
+      "[[0.5 0.5 0.3]\n",
+      " [0.7 0.8 0.9]\n",
+      " [0.5 0.  5. ]]\n"
+     ]
+    }
+   ],
+   "source": [
+    "from sklearn.metrics import pairwise_distances\n",
+    "import numpy as np\n",
+    "\n",
+    "def find_optimal_mapping(cloud_a: np.ndarray, cloud_b: np.ndarray) -> np.ndarray:\n",
+    "    dist = pairwise_distances(cloud_a, cloud_b)\n",
+    "    result_mapping = np.zeros(cloud_a.shape[0])\n",
+    "    mapping = dict()\n",
+    "    for i in range(cloud_a.shape[0]):\n",
+    "        curr_point = i\n",
+    "        occ = np.argmin(dist[curr_point])\n",
+    "        while occ in mapping.keys():\n",
+    "            if dist[mapping.get(occ)][occ] > dist[curr_point][occ]:\n",
+    "                result_mapping[curr_point] = occ\n",
+    "                dist[mapping.get(occ)][occ] = np.inf\n",
+    "                mapping[occ] = curr_point\n",
+    "                curr_point = mapping.get(occ)\n",
+    "            else:\n",
+    "                dist[curr_point][occ] = np.inf\n",
+    "            occ = np.argmin(dist[curr_point])\n",
+    "        result_mapping[curr_point] = occ\n",
+    "        mapping[occ] = curr_point\n",
+    "\n",
+    "    result = np.zeros(cloud_a.shape)\n",
+    "    for i in range(cloud_a.shape[0]):\n",
+    "        result[i] = cloud_b[int(result_mapping[i])]\n",
+    "    return result\n",
+    "\n",
+    "print(find_optimal_mapping(np.array([\n",
+    "    [0, 0, 0],\n",
+    "    [1, 1, 1],\n",
+    "    [2, 2, 2]\n",
+    "]), np.array([\n",
+    "    [0.7, 0.8, 0.9],\n",
+    "    [0.5, 0.5, 0.3],\n",
+    "    [0.5, 0, 5]\n",
+    "])))"
+   ]
+  },
+  {
    "cell_type": "code",
    "execution_count": null,
-   "metadata": {},
    "outputs": [],
-   "source": []
+   "source": [],
+   "metadata": {
+    "collapsed": false
+   }
   }
  ],
  "metadata": {
Index: .idea/inspectionProfiles/Project_Default.xml
===================================================================
diff --git a/.idea/inspectionProfiles/Project_Default.xml b/.idea/inspectionProfiles/Project_Default.xml
new file mode 100644
--- /dev/null	
+++ b/.idea/inspectionProfiles/Project_Default.xml	
@@ -0,0 +1,12 @@
+<component name="InspectionProjectProfileManager">
+  <profile version="1.0">
+    <option name="myName" value="Project Default" />
+    <inspection_tool class="PyPep8NamingInspection" enabled="true" level="WEAK WARNING" enabled_by_default="true">
+      <option name="ignoredErrors">
+        <list>
+          <option value="N806" />
+        </list>
+      </option>
+    </inspection_tool>
+  </profile>
+</component>
\ No newline at end of file
Index: .idea/DiffRNAFold.iml
===================================================================
diff --git a/.idea/DiffRNAFold.iml b/.idea/DiffRNAFold.iml
new file mode 100644
--- /dev/null	
+++ b/.idea/DiffRNAFold.iml	
@@ -0,0 +1,8 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<module type="PYTHON_MODULE" version="4">
+  <component name="NewModuleRootManager">
+    <content url="file://$MODULE_DIR$" />
+    <orderEntry type="jdk" jdkName="Python 3.9" jdkType="Python SDK" />
+    <orderEntry type="sourceFolder" forTests="false" />
+  </component>
+</module>
\ No newline at end of file
Index: .idea/modules.xml
===================================================================
diff --git a/.idea/modules.xml b/.idea/modules.xml
new file mode 100644
--- /dev/null	
+++ b/.idea/modules.xml	
@@ -0,0 +1,8 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="ProjectModuleManager">
+    <modules>
+      <module fileurl="file://$PROJECT_DIR$/.idea/DiffRNAFold.iml" filepath="$PROJECT_DIR$/.idea/DiffRNAFold.iml" />
+    </modules>
+  </component>
+</project>
\ No newline at end of file
Index: .idea/inspectionProfiles/profiles_settings.xml
===================================================================
diff --git a/.idea/inspectionProfiles/profiles_settings.xml b/.idea/inspectionProfiles/profiles_settings.xml
new file mode 100644
--- /dev/null	
+++ b/.idea/inspectionProfiles/profiles_settings.xml	
@@ -0,0 +1,6 @@
+<component name="InspectionProjectProfileManager">
+  <settings>
+    <option name="USE_PROJECT_PROFILE" value="false" />
+    <version value="1.0" />
+  </settings>
+</component>
\ No newline at end of file
Index: .idea/vcs.xml
===================================================================
diff --git a/.idea/vcs.xml b/.idea/vcs.xml
new file mode 100644
--- /dev/null	
+++ b/.idea/vcs.xml	
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="VcsDirectoryMappings">
+    <mapping directory="$PROJECT_DIR$" vcs="Git" />
+  </component>
+</project>
\ No newline at end of file
Index: .idea/.gitignore
===================================================================
diff --git a/.idea/.gitignore b/.idea/.gitignore
new file mode 100644
--- /dev/null	
+++ b/.idea/.gitignore	
@@ -0,0 +1,8 @@
+# Default ignored files
+/shelf/
+/workspace.xml
+# Editor-based HTTP Client requests
+/httpRequests/
+# Datasource local storage ignored files
+/dataSources/
+/dataSources.local.xml
